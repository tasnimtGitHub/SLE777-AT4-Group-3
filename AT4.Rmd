---
title: "AT4"
author: "Tasfia Tasnim, Tanjila Tabassum, Razieh Fathinezhad)"
date: "2024-10-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


## This chunk contains the codes for:
1. Downloading gene_expression.tsv
2. Reading the tsv file
3. Showing the table of the first six genes

```{r}
URL="https://raw.githubusercontent.com/ghazkha/Assessment4/refs/heads/main/gene_expression.tsv"
download.file(URL,destfile="gene_expression.tsv")
expression <- read.table(URL,stringsAsFactors = FALSE, header=TRUE)
expression
firstsixgenes <- expression[1:6,]
firstsixgenes

```

## This chunk contains the codes for:
1. Creating a column which is the mean of other columns
```{r}
expression$GTEX.1117F.0226.SM.5GZZ7 <- as.numeric(expression$GTEX.1117F.0226.SM.5GZZ7)
expression$GTEX.1117F.0426.SM.5EGHI <- as.numeric(expression$GTEX.1117F.0426.SM.5EGHI)
expression$GTEX.1117F.0526.SM.5EGHJ <- as.numeric(expression$GTEX.1117F.0526.SM.5EGHJ)

expression$columnmeans <- rowMeans(expression[,2:4])
head(expression)

```

## This chunk contains the codes for:
1. Determining the 10 genes with highest expressed mean.
```{r}
expression_sorted <- expression[order(-expression$columnmeans), ]
top_10_genes <- head(expression_sorted, 10)
top_10_genes
```

## This chunk contains the code for:
1. Determining the Number of genes mean <10
```{r}
lessexpressed <- subset(expression, columnmeans < 10)
lessexpressed

```

## This chunk contains the code for:
1. Creating histogram of mean values
```{r}
hist(expression$columnmeans,xlab="gene expression",main="mean expression")
```


## This chunk contains code for:
1. installing packages
```{r}
library(R.utils)
library("seqinr")
```

## This chunk contains codes for:
1. Downloading the E.coli and Mycobacterium genomes
2. Reading the files
```{r}
URL="https://ftp.ensemblgenomes.ebi.ac.uk/pub/bacteria/release-59/fasta/bacteria_0_collection/escherichia_coli_str_k_12_substr_mg1655_gca_000005845/cds/Escherichia_coli_str_k_12_substr_mg1655_gca_000005845.ASM584v2.cds.all.fa.gz"
download.file(URL,destfile="ecoli_cds.fa.gz")
gunzip("ecoli_cds.fa.gz")
cds <- seqinr::read.fasta("ecoli_cds.fa")
URL = "https://ftp.ensemblgenomes.ebi.ac.uk/pub/bacteria/release-59/fasta/bacteria_4_collection/mycobacterium_tuberculosis_gca_001318445/cds/Mycobacterium_tuberculosis_gca_001318445.6505_5_10.cds.all.fa.gz"
download.file(URL,destfile="mycobacterium_cds.fa.gz")
gunzip("mycobacterium_cds.fa.gz")
cds_mycobacterium <- seqinr::read.fasta("mycobacterium_cds.fa")

```
## This chunk contains codes for:
1. Counting the lengths
2. Creating a table of the length
```{r}
length(cds)
length(cds_mycobacterium)
table <- data.frame(
  E.coli = 4239,
  Mycobacterium = 4741
)
print(table)


```
## This chunk contains code for:
1. Calculating total Coding DNA
2. Creating a table of Total Coding DNA
```{r}
head(summary(cds))
head(summary(cds_mycobacterium))

len <- as.numeric(summary(cds)[,1])
lenm <- as.numeric(summary(cds_mycobacterium)[,1])
sum(len)
sum(lenm)
table <- data.frame(
  E.coli = 3978528,
  Mycobacterium = 3076728
)
print(table)
```

